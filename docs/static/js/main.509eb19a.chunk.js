(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(t,e,a){t.exports=a(36)},16:function(t,e,a){},18:function(t,e,a){},20:function(t,e,a){},34:function(t,e,a){},36:function(t,e,a){"use strict";a.r(e);var s=a(0),i=a.n(s),n=a(7),o=(a(16),a(18),function(){return i.a.createElement("div",{className:"AppHeader"},i.a.createElement("div",{className:"AppHeader-title"},"\u3077\u3088\u305f\u3093\u03b2"),i.a.createElement("div",{className:"AppHeader-version"},"v0.1"))}),r=a(1),c=a(2),l=a(9),h=a(8),u=a(10),d=(a(20),function(){function t(e){Object(r.a)(this,t),this.y=null==e?2147483647*Math.random():e}return Object(c.a)(t,[{key:"setSeed",value:function(t){this.y=t}},{key:"next",value:function(){return this.y=this.y^this.y<<13,this.y=this.y^this.y>>17,this.y=this.y^this.y<<15,this.y>>>0}},{key:"nextInt",value:function(t){return Math.abs(this.next())%t}}]),t}()),m={BRANK:0,RED:1,GREEN:2,BLUE:3,YELLOW:4,PURPLE:5,IRON:6,OJAMA:7,WALL:8,PEKE:9},f=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.BRANK,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.BRANK;Object(r.a)(this,t),this.axis=e,this.sub=a},y=function(){function t(e,a){Object(r.a)(this,t),this.init(e,a)}return Object(c.a)(t,[{key:"init",value:function(t,e){(null==e&&(e="random"),this._mode=e,null==t)&&(t=(new d).nextInt(16777216));this._seed=t,this._random=new d(this._seed),this._size=1e3,this._puyos=[];for(var a=0;a<this._size;a++)this._puyos.push(new f(this._nextKind(),this._nextKind()))}},{key:"size",value:function(){return this._size}},{key:"get",value:function(t){return this._puyos[t%this._size]}},{key:"seed",value:function(){return this._seed}},{key:"edit",value:function(t,e,a){t>=this._size||t<0||(a?this._puyos[t].axis=e:this._puyos[t].sub=e)}},{key:"_nextKind",value:function(){switch(this._random.nextInt(4)){case 0:return m.RED;case 1:return m.GREEN;case 2:return m.BLUE;case 3:return m.YELLOW;default:throw new Error("unexpected error")}}}]),t}(),v=function t(e,a){Object(r.a)(this,t),this.x=isNaN(e)?0:e,this.y=isNaN(a)?0:a},p=function(){function t(){Object(r.a)(this,t),this.height=13,this.width=6,this._field=[];for(var e=0;e<this.height+1;e++){for(var a=[],s=0;s<this.width;s++)a.push(m.BRANK);this._field.push(a)}}return Object(c.a)(t,[{key:"isBrank",value:function(t){return this.get(t)===m.BRANK}},{key:"get",value:function(t){return t.y<1||t.x<1||t.x>this.width?m.WALL:t.y>this.height?m.BRANK:this._field[t.y-1][t.x-1]}},{key:"set",value:function(t,e){t.y<1||t.y>this.height+1||t.x<1||t.x>this.width||(this._field[t.y-1][t.x-1]=e)}},{key:"setAndFall",value:function(t,e){if(t<1||t>this.width)throw RangeError("out of field.");this.isBrank(new v(t,13))&&(this.set(new v(t,13),e),this.fall())}},{key:"fall",value:function(){for(var t=!1,e=1;e<=this.width;e++)for(var a=1,s=1;s<=this.height+1;s++){var i=this.get(new v(e,s));i!==m.BRANK&&(i!==m.WALL?(this.set(new v(e,s),this.get(new v(e,a))),this.set(new v(e,a),i),a!==s&&(t=!0),a++):a=s+1)}for(var n=1;n<=this.width;n++)this.set(new v(n,14),m.BRANK);return t}},{key:"canFall",value:function(){for(var t=1;t<=this.width;t++)for(var e=2;e<=this.height;e++)if(this.isBrank(new v(t,e-1))&&!this.isBrank(new v(t,e))&&this.get(new v(t,e))!==m.WALL)return!0;return!1}},{key:"_countConnection",value:function(t,e,a){return this.get(t)===m.IRON?0:this.get(t)===m.PEKE?0:this.get(t)===m.WALL?0:this.get(t)===m.BRANK?0:this.get(t)===m.OJAMA?0:this.get(t)!==e?0:a.get(t)!==m.BRANK?0:t.y>=13?0:(a.set(t,e),this._countConnection(new v(t.x,t.y+1),e,a)+this._countConnection(new v(t.x+1,t.y),e,a)+this._countConnection(new v(t.x,t.y-1),e,a)+this._countConnection(new v(t.x-1,t.y),e,a)+1)}},{key:"countConnection",value:function(e){return this._countConnection(e,this.get(e),new t)}},{key:"_deleteConnection",value:function(t,e){return this.get(t)===m.BRANK?0:this.get(t)===m.OJAMA?(this.set(t,m.BRANK),0):this.get(t)!==e?0:t.y>=13?0:(this.set(t,m.BRANK),this._deleteConnection(new v(t.x,t.y+1),e)+this._deleteConnection(new v(t.x+1,t.y),e)+this._deleteConnection(new v(t.x,t.y-1),e)+this._deleteConnection(new v(t.x-1,t.y),e)+1)}},{key:"deleteConnection",value:function(t){return this._deleteConnection(t,this.get(t))}},{key:"canFire",value:function(){for(var e=new t,a=1;a<this.height;a++)for(var s=1;s<=this.width;s++){var i=new v(s,a);if(this._countConnection(i,this.get(i),e)>=4)return!0}return!1}},{key:"stepFire",value:function(){for(var e=new function t(){Object(r.a)(this,t),this.num=0,this.connections=[],this.color=0},a=new t,s={},i=1;i<this.height;i++)for(var n=1;n<=this.width;n++){var o=new v(n,i),c=this.get(o),l=this._countConnection(o,c,a);l>=4&&(this.deleteConnection(o),e.num+=l,e.connections.push(l),s[c]=!0)}return e.color=Object.keys(s).length,e}},{key:"Height",value:function(){return this.height}},{key:"Width",value:function(){return this.width}},{key:"copy",value:function(){for(var e=new t,a=1;a<=this.height;a++)for(var s=1;s<=this.width;s++){var i=new v(s,a);e.set(i,this.get(i))}return e}},{key:"equal",value:function(t){for(var e=1;e<=this.height;e++)for(var a=1;a<=this.width;a++){var s=new v(a,e);if(this.get(s)!==t.get(s))return!1}return!0}},{key:"isAllClear",value:function(){for(var t=1;t<=this.height;t++)for(var e=1;e<=this.width;e++){var a=new v(e,t);if(this.get(a)!==m.BRANK)return!1}return!0}},{key:"map",value:function(t){for(var e=[],a=1;a<=this.height;a++)for(var s=1;s<=this.width;s++){var i=new v(s,a),n=this.get(i);e.push(t(i,n))}return e}},{key:"toString",value:function(){var t=this.copy()._field;return t.reverse(),t.map(function(t){return t.join(",")}).join("\n")}}]),t}(),P={Kind:m,Pos:v,Next:y,Field:p,PuyoPair:f},A={PASS:0,PUT:1,CHAIN:2,CHAIN_FALL:3,OJAMA:4},w=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A.PASS,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(r.a)(this,t),this.type=e,this.x=a,this.dir=s},g=function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)(this,t),this.action=e,this.remainingFrame=a},x=function(){function t(){Object(r.a)(this,t),this.field=new P.Field,this.actionHistories=[],this.activeNextPos=0,this.score=0,this.usedScore=0,this.nonActiveOjama=0,this.activeOjama=0,this.chain=0,this.random=new d}return Object(c.a)(t,[{key:"fallOjama",value:function(t){for(;t>0;)if(t>=6){for(var e=1;e<=6;e++)this.field.setAndFall(e,P.Kind.OJAMA);t-=6}else{for(var a=[!1,!1,!1,!1,!1,!1],s=0;s<t;s++)for(var i=this.random.nextInt(6-s),n=0,o=0;o<6;o++)a[o]||n++===i&&(a[o]=!0);for(var r=1;r<=6;r++)a[r-1]&&this.field.setAndFall(r,P.Kind.OJAMA);t=0}}}]),t}(),k={Puyotan:function(){function t(){Object(r.a)(this,t),this.next=new P.Next,this.players=[new x,new x],this.frame=0,this.gameStatusText="\u5f85\u6a5f\u4e2d"}return Object(c.a)(t,[{key:"getPlayer",value:function(t){return this.players[t]}},{key:"start",value:function(){0===this.frame&&(this.frame++,this.gameStatusText="\u5bfe\u6226\u4e2d")}},{key:"setAction",value:function(t,e){if(!(this.frame<=0)&&null==this.players[t].actionHistories[this.frame])switch(e.type){case A.PASS:this.players[t].actionHistories[this.frame]=new g(e,0);break;case A.PUT:this.players[t].actionHistories[this.frame]=new g(e,1);break;default:throw new Error("unsupported action type.")}}},{key:"canStepNextFrame",value:function(){var t=this;return!(this.frame<=0)&&this.players.every(function(e){return null!=e.actionHistories[t.frame]})}},{key:"stepNextFrame",value:function(){var t=this;if(!this.canStepNextFrame())return console.error("can not step next frame.");this.players.forEach(function(e,a){var s=e.actionHistories[t.frame];s.remainingFrame>0&&(e.actionHistories[t.frame+1]=new g(s.action,s.remainingFrame-1))}),this.players.forEach(function(e,a){var s=e.actionHistories[t.frame];if(0===s.remainingFrame)switch(s.action.type){case A.PASS:break;case A.PUT:var i=t.next.get(e.activeNextPos),n=s.action.x,o=s.action.dir;switch(o){case 0:e.field.setAndFall(n,i.axis),e.field.setAndFall(n,i.sub);break;case 1:e.field.setAndFall(n,i.axis),e.field.setAndFall(n+1,i.sub);break;case 2:e.field.setAndFall(n,i.sub),e.field.setAndFall(n,i.axis);break;case 3:e.field.setAndFall(n,i.axis),e.field.setAndFall(n-1,i.sub);break;default:throw Error("unsupported direction range or type. ".concat(o))}e.field.canFire()&&(e.chain=0,e.actionHistories[t.frame+1]=new g(new w(A.CHAIN),1));break;case A.CHAIN:var r=e.field.stepFire();e.chain++,e.score+=t.calcScore(r.num,r.color,r.connections,e.chain);var c=Math.floor((e.score-e.usedScore)/70);if(e.usedScore+=70*c,e.nonActiveOjama>0){var l=Math.min(c,e.nonActiveOjama);e.nonActiveOjama-=l,c-=l}if(e.activeOjama>0){var h=Math.min(c,e.activeOjama);e.activeOjama-=h,c-=h}c>0&&t.sendOjama(a,c),e.field.canFall()?e.actionHistories[t.frame+1]=new g(new w(A.CHAIN_FALL),0):t.activeOjama(a);break;case A.CHAIN_FALL:if(!e.field.canFall())throw new Error("failed to fall puyo.");e.field.fall(),e.field.canFire()?e.actionHistories[t.frame+1]=new g(new w(A.CHAIN),1):t.activeOjama(a);break;case A.OJAMA:if(e.activeOjama<=0)throw new Error("failed to fall ojama.");var u=Math.min(e.activeOjama,30);e.activeOjama-=u,e.fallOjama(u);break;default:throw new Error("unsupported action type.")}});var e=0,a=0;this.players.forEach(function(s,i){null==s.actionHistories[t.frame+1]&&s.field.get(new P.Pos(3,12))!==P.Kind.BRANK||(e++,a=i)}),0===e&&(this.gameStatusText="\u5f15\u304d\u5206\u3051\u2026"),1===e&&(this.gameStatusText="Player ".concat(a+1," \u306e\u52dd\u5229\uff01")),this.players.forEach(function(e,a){e.actionHistories[t.frame].action.type!==A.OJAMA&&null==e.actionHistories[t.frame+1]&&e.activeOjama>0&&(e.actionHistories[t.frame+1]=new g(new w(A.OJAMA),0))}),this.players.forEach(function(e,a){var s=e.actionHistories[t.frame],i=e.actionHistories[t.frame+1];s.action.type!==A.PASS&&null==i&&e.activeNextPos++}),this.frame++}},{key:"calcScore",value:function(t,e,a,s){var i=[0,2,3,4,5,6,7,10],n=10*t,o=[0,8,16,32,64,96,128,160,192,224,256,288,320,352,384,416,448,480,512][s-1];void 0===o&&(o=512),o+=[0,3,6,12,24][e-1];for(var r=0;r<a.length;r++){var c=a[r];o+=c>11?10:i[c-4]}return 0===o&&(o=1),n*o}},{key:"sendOjama",value:function(t,e){this.players.forEach(function(a,s){s!==t&&(a.nonActiveOjama+=e)})}},{key:"activeOjama",value:function(t){this.players.forEach(function(e,a){a!==t&&(e.activeOjama+=e.nonActiveOjama,e.nonActiveOjama=0)})}},{key:"getViewModel",value:function(){var t=this;return{frame:this.frame,players:this.players.map(function(e){return{activePair:0===t.frame?new P.PuyoPair:t.next.get(e.activeNextPos),next1:0===t.frame?t.next.get(0):t.next.get(e.activeNextPos+1),next2:0===t.frame?t.next.get(1):t.next.get(e.activeNextPos+2),field:e.field,actionHistories:e.actionHistories,chain:e.chain,score:e.score,usedScore:e.usedScore,nonActiveOjama:e.nonActiveOjama,activeOjama:e.activeOjama}}),gameStatusText:this.gameStatusText}}}]),t}(),Action:w,ActionType:A,Player:x},N=a(4),E=a.n(N);a(29);E.a.initializeApp({apiKey:"AIzaSyDNckvdwFU9B-Xg3YPY-tgsrj09kg0MTxE",authDomain:"puyotan-be458.firebaseapp.com",databaseURL:"https://puyotan-be458.firebaseio.com",projectId:"puyotan-be458",storageBucket:"puyotan-be458.appspot.com",messagingSenderId:"1067679324903"});var O=E.a.firestore();O.settings({timestampsInSnapshots:!0});var S=function(t){function e(t){var a;Object(r.a)(this,e),(a=Object(l.a)(this,Object(h.a)(e).call(this,t))).puyotan=new k.Puyotan;var s=a.puyotan.getViewModel();return a.state={controledPos1:0,controledDir1:0,controledPos2:0,controledDir2:0,isControlledPlayer1:!0,isControlledPlayer2:!0},Object.assign(a.state,a.puyotanViewModelToStateObject(s)),a.isControllable=!0,window.addEventListener("keydown",function(t){if(t.preventDefault(),a.isControllable)switch(t.keyCode){case 37:return void a.moveLeft();case 39:return void a.moveRight();case 38:return;case 40:return void a.putPuyo();case 49:return void a.toggleControlledPlayer1();case 50:return void a.toggleControlledPlayer2();case 51:case 52:case 53:case 54:case 55:case 56:return;case 88:return void a.turnRight();case 90:return void a.turnLeft();case 67:case 68:case 69:return;case 78:return void a.stepNextFrame();case 80:return void a.pass();case 82:return;case 83:return void a.gameStart();case 84:default:return}}),O.collection("puyotan/histories/0").onSnapshot(function(t){t.forEach(function(t){a.state.frame===t.id&&a.setAction(0,t.data())})}),O.collection("puyotan/histories/1").onSnapshot(function(t){t.forEach(function(t){a.state.frame===t.id&&a.setAction(1,t.data())})}),a}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"Game"},i.a.createElement("div",{className:"Game-history Game-pos-history1"},this.actionHistoriesToElements(this.state.actionHistories1)),i.a.createElement("div",{className:"Game-history Game-pos-history2"},this.actionHistoriesToElements(this.state.actionHistories2)),i.a.createElement("div",{className:"Game-field Game-pos-field1"+(this.state.isControlledPlayer1?" Game-field-active":"")},this.fieldToElements(this.state.field1),i.a.createElement("div",{style:{top:32*(10-this.getSubPos1().y),left:32*(this.getSubPos1().x-1)},className:"Game-puyo ".concat(this.kindToClassName(this.state.activePair1.sub)," ").concat(null==this.state.actionHistories1[this.state.frame]&&this.state.isControlledPlayer1?"":"hidden")}),i.a.createElement("div",{style:{top:32*(10-this.getAxisPos1().y),left:32*(this.getAxisPos1().x-1)},className:"Game-puyo ".concat(this.kindToClassName(this.state.activePair1.axis)," ").concat(null==this.state.actionHistories1[this.state.frame]&&this.state.isControlledPlayer1?"":"hidden")})),i.a.createElement("div",{className:"Game-field Game-pos-field2"+(this.state.isControlledPlayer2?" Game-field-active":"")},this.fieldToElements(this.state.field2),i.a.createElement("div",{style:{top:32*(10-this.getSubPos2().y),left:32*(this.getSubPos2().x-1)},className:"Game-puyo ".concat(this.kindToClassName(this.state.activePair2.sub)," ").concat(null==this.state.actionHistories2[this.state.frame]&&this.state.isControlledPlayer2?"":"hidden")}),i.a.createElement("div",{style:{top:32*(10-this.getAxisPos2().y),left:32*(this.getAxisPos2().x-1)},className:"Game-puyo ".concat(this.kindToClassName(this.state.activePair2.axis)," ").concat(null==this.state.actionHistories2[this.state.frame]&&this.state.isControlledPlayer2?"":"hidden")})),i.a.createElement("div",{className:"Game-next Game-pos-next11"},this.nextToElements(this.state.next11)),i.a.createElement("div",{className:"Game-next Game-pos-next12"},this.nextToElements(this.state.next12)),i.a.createElement("div",{className:"Game-next Game-pos-next21"},this.nextToElements(this.state.next21)),i.a.createElement("div",{className:"Game-next Game-pos-next22"},this.nextToElements(this.state.next22)),i.a.createElement("div",{className:"Game-pos-chain1"},this.state.chain1," CHAIN"),i.a.createElement("div",{className:"Game-pos-chain2"},this.state.chain2," CHAIN"),i.a.createElement("div",{className:"Game-pos-score1"},this.state.score1," \u70b9"),i.a.createElement("div",{className:"Game-pos-score2"},this.state.score2," \u70b9"),i.a.createElement("div",{className:"Game-pos-usedScore1"},this.state.usedScore1," \u70b9"),i.a.createElement("div",{className:"Game-pos-usedScore2"},this.state.usedScore2," \u70b9"),i.a.createElement("div",{className:"Game-pos-activeOjama1"},"\u30a2\u30af\u30c6\u30a3\u30d6\u304a\u3058\u3083\u307e ",this.state.activeOjama1," \u500b"),i.a.createElement("div",{className:"Game-pos-activeOjama2"},"\u30a2\u30af\u30c6\u30a3\u30d6\u304a\u3058\u3083\u307e ",this.state.activeOjama2," \u500b"),i.a.createElement("div",{className:"Game-pos-nonActiveOjama1"},"\u975e\u30a2\u30af\u30c6\u30a3\u30d6\u304a\u3058\u3083\u307e ",this.state.nonActiveOjama1," \u500b"),i.a.createElement("div",{className:"Game-pos-nonActiveOjama2"},"\u975e\u30a2\u30af\u30c6\u30a3\u30d6\u304a\u3058\u3083\u307e ",this.state.nonActiveOjama2," \u500b"),i.a.createElement("div",{className:"Game-pos-frame"},"frame: ",this.state.frame),i.a.createElement("div",{className:"Game-pos-gameStatusText"},"statusText: ",this.state.gameStatusText))}},{key:"actionHistoriesToElements",value:function(t){for(var e=[],a=this.state.frame;a>=1;a--){var s=t[a],n="";if(null!=s){switch(s.action.type){case k.ActionType.PASS:n="PASS";break;case k.ActionType.PUT:n="PUT(".concat(s.action.x,", ").concat(s.action.dir,")");break;case k.ActionType.CHAIN:n="CHAIN";break;case k.ActionType.CHAIN_FALL:n="CHAIN_FALL";break;case k.ActionType.OJAMA:n="OJAMA";break;default:n="unknown type"}n="".concat(n," ").concat(s.remainingFrame)}var o={top:32*(this.state.frame-a)};e.push(i.a.createElement("div",{key:a,style:o,className:"Game-history-tile"},a,":",n))}return e}},{key:"fieldToElements",value:function(t){var e=this;return t.map(function(t,a){var s={left:32*(t.x-1),top:32*(13-t.y)},n=e.kindToClassName(a);return i.a.createElement("div",{key:"".concat(t.x,"_").concat(t.y),style:s,className:"Game-puyo ".concat(n)})})}},{key:"nextToElements",value:function(t){return[i.a.createElement("div",{key:"sub",className:"Game-puyo ".concat(this.kindToClassName(t.sub))}),i.a.createElement("div",{key:"axs",className:"Game-puyo ".concat(this.kindToClassName(t.axis)),style:{top:32}})]}},{key:"kindToClassName",value:function(t){switch(t){case P.Kind.RED:return"Game-puyo-kind-red";case P.Kind.BLUE:return"Game-puyo-kind-blue";case P.Kind.GREEN:return"Game-puyo-kind-green";case P.Kind.YELLOW:return"Game-puyo-kind-yellow";case P.Kind.OJAMA:return"Game-puyo-kind-ojama";default:return"Game-puyo-kind-blank"}}},{key:"toggleControlledPlayer1",value:function(){this.setState({isControlledPlayer1:!this.state.isControlledPlayer1})}},{key:"toggleControlledPlayer2",value:function(){this.setState({isControlledPlayer2:!this.state.isControlledPlayer2})}},{key:"reflectPuyotanView",value:function(t){this.setState(this.puyotanViewModelToStateObject(t))}},{key:"gameStart",value:function(){this.puyotan.start();var t=this.puyotan.getViewModel();this.reflectPuyotanView(t),this.setState({controledPos1:3,controledDir1:0,controledPos2:3,controledDir2:0})}},{key:"setAction",value:function(t,e){this.puyotan.setAction(t,e),O.collection("puyotan/histories/".concat(t)).doc(String(this.state.frame)).set({type:e.type,x:e.x,dir:e.dir}).then(function(){console.log("Document successfully written!")}).catch(function(t){throw Error(t)})}},{key:"moveLeft",value:function(){this.state.isControlledPlayer1&&(this.state.controledPos1>2||2===this.state.controledPos1&&3!==this.state.controledDir1)&&this.setState({controledPos1:this.state.controledPos1-1}),this.state.isControlledPlayer2&&(this.state.controledPos2>2||2===this.state.controledPos2&&3!==this.state.controledDir2)&&this.setState({controledPos2:this.state.controledPos2-1})}},{key:"moveRight",value:function(){this.state.isControlledPlayer1&&(this.state.controledPos1<5||5===this.state.controledPos1&&1!==this.state.controledDir1)&&this.setState({controledPos1:this.state.controledPos1+1}),this.state.isControlledPlayer2&&(this.state.controledPos2<5||5===this.state.controledPos2&&1!==this.state.controledDir2)&&this.setState({controledPos2:this.state.controledPos2+1})}},{key:"turnLeft",value:function(){if(this.state.isControlledPlayer1){var t=0;1===this.state.controledPos1&&0===this.state.controledDir1&&(t=1),6===this.state.controledPos1&&2===this.state.controledDir1&&(t=-1),this.setState({controledDir1:(this.state.controledDir1+3)%4,controledPos1:this.state.controledPos1+t})}if(this.state.isControlledPlayer2){var e=0;1===this.state.controledPos2&&0===this.state.controledDir2&&(e=1),6===this.state.controledPos2&&2===this.state.controledDir2&&(e=-1),this.setState({controledDir2:(this.state.controledDir2+3)%4,controledPos2:this.state.controledPos2+e})}}},{key:"turnRight",value:function(){if(this.state.isControlledPlayer1){var t=0;1===this.state.controledPos1&&2===this.state.controledDir1&&(t=1),6===this.state.controledPos1&&0===this.state.controledDir1&&(t=-1),this.setState({controledDir1:(this.state.controledDir1+1)%4,controledPos1:this.state.controledPos1+t})}if(this.state.isControlledPlayer2){var e=0;1===this.state.controledPos2&&2===this.state.controledDir2&&(e=1),6===this.state.controledPos2&&0===this.state.controledDir2&&(e=-1),this.setState({controledDir2:(this.state.controledDir2+1)%4,controledPos2:this.state.controledPos2+e})}}},{key:"putPuyo",value:function(){this.state.isControlledPlayer1&&(this.setAction(0,new k.Action(k.ActionType.PUT,this.state.controledPos1,this.state.controledDir1)),this.setState({controledPos1:3,controledDir1:0})),this.state.isControlledPlayer2&&(this.setAction(1,new k.Action(k.ActionType.PUT,this.state.controledPos2,this.state.controledDir2)),this.setState({controledPos2:3,controledDir2:0})),this.stepNextFrame()}},{key:"pass",value:function(){this.state.isControlledPlayer1&&(this.setAction(0,new k.Action(k.ActionType.PASS)),this.setState({controledPos1:3,controledDir1:0})),this.state.isControlledPlayer2&&(this.setAction(1,new k.Action(k.ActionType.PASS)),this.setState({controledPos2:3,controledDir2:0})),this.stepNextFrame()}},{key:"getAxisPos1",value:function(){return new P.Pos(this.state.controledPos1,12)}},{key:"getAxisPos2",value:function(){return new P.Pos(this.state.controledPos2,12)}},{key:"getSubPos1",value:function(){switch(this.state.controledDir1){case 0:return new P.Pos(this.state.controledPos1,13);case 1:return new P.Pos(this.state.controledPos1+1,12);case 2:return new P.Pos(this.state.controledPos1,11);case 3:return new P.Pos(this.state.controledPos1-1,12);default:throw Error("unsupported dir ".concat(this.state.controledDir1))}}},{key:"getSubPos2",value:function(){switch(this.state.controledDir2){case 0:return new P.Pos(this.state.controledPos2,13);case 1:return new P.Pos(this.state.controledPos2+1,12);case 2:return new P.Pos(this.state.controledPos2,11);case 3:return new P.Pos(this.state.controledPos2-1,12);default:throw Error("unsupported dir ".concat(this.state.controledDir2))}}},{key:"stepNextFrame",value:function(){var t=this;this.puyotan.stepNextFrame();var e=this.puyotan.getViewModel();this.reflectPuyotanView(e),null!=e.players[0].actionHistories[e.frame]&&null!=e.players[1].actionHistories[e.frame]?(this.isControllable=!1,setTimeout(function(){t.stepNextFrame()},500)):this.isControllable=!0}},{key:"puyotanViewModelToStateObject",value:function(t){return{activePair1:t.players[0].activePair,activePair2:t.players[1].activePair,field1:t.players[0].field,field2:t.players[1].field,next11:t.players[0].next1,next12:t.players[0].next2,next21:t.players[1].next1,next22:t.players[1].next2,frame:t.frame,actionHistories1:t.players[0].actionHistories,actionHistories2:t.players[1].actionHistories,chain1:t.players[0].chain,chain2:t.players[1].chain,score1:t.players[0].score,score2:t.players[1].score,usedScore1:t.players[0].usedScore,usedScore2:t.players[1].usedScore,nonActiveOjama1:t.players[0].nonActiveOjama,nonActiveOjama2:t.players[1].nonActiveOjama,activeOjama1:t.players[0].activeOjama,activeOjama2:t.players[1].activeOjama,gameStatusText:t.gameStatusText}}}]),e}(i.a.Component),j=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(o,null),i.a.createElement(S,null))};a(34);Object(n.render)(i.a.createElement(j,null),document.getElementById("root"))}},[[11,2,1]]]);
//# sourceMappingURL=main.509eb19a.chunk.js.map